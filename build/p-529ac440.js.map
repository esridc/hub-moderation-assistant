{"version":3,"names":["isFirefox","test","getUserAgentString","disabledElementToParent","WeakMap","interceptedClick","disabled","this","HTMLElement","prototype","click","call","onPointerDown","event","interactiveElement","target","get","preventDefault","nonBubblingWhenDisabledMouseEvents","onNonBubblingWhenDisabledMouseEvent","stopImmediatePropagation","captureOnlyOptions","capture","updateHostInteraction","component","el","setAttribute","contains","document","activeElement","blur","blockInteraction","restoreInteraction","removeAttribute","currentParent","getParentElement","trackedParent","removeInteractionListeners","set","addInteractionListeners","element","addEventListener","forEach","parentElement","isInteractiveHTMLElement","parent","hasDisabledSiblingElements","children","child","delete","removeEventListener","connectInteractive","disconnectInteractive","CSS","container","InteractiveContainer","h","class","inert"],"sources":["./node_modules/@esri/calcite-components/dist/collection/utils/interactive.js"],"sourcesContent":["/*!\n * All material copyright ESRI, All Rights Reserved, unless otherwise specified.\n * See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.\n * v2.11.1\n */\nimport { h } from \"@stencil/core\";\nimport { getUserAgentString } from \"./browser\";\n// ⚠️ browser-sniffing is not a best practice and should be avoided ⚠️\nconst isFirefox = /firefox/i.test(getUserAgentString());\nconst disabledElementToParent = isFirefox\n    ? new WeakMap()\n    : null;\nfunction interceptedClick() {\n    const { disabled } = this;\n    if (!disabled) {\n        HTMLElement.prototype.click.call(this);\n    }\n}\nfunction onPointerDown(event) {\n    const interactiveElement = event.target;\n    if (isFirefox && !disabledElementToParent.get(interactiveElement)) {\n        return;\n    }\n    const { disabled } = interactiveElement;\n    if (disabled) {\n        // prevent click from moving focus on host\n        event.preventDefault();\n    }\n}\nconst nonBubblingWhenDisabledMouseEvents = [\"mousedown\", \"mouseup\", \"click\"];\nfunction onNonBubblingWhenDisabledMouseEvent(event) {\n    const interactiveElement = event.target;\n    if (isFirefox && !disabledElementToParent.get(interactiveElement)) {\n        return;\n    }\n    // prevent disallowed mouse events from being emitted on the disabled host (per https://github.com/whatwg/html/issues/5886)\n    // ⚠ we generally avoid stopping propagation of events, but this is needed to adhere to the intended spec changes above ⚠\n    if (interactiveElement.disabled) {\n        event.stopImmediatePropagation();\n        event.preventDefault();\n    }\n}\nconst captureOnlyOptions = { capture: true };\n/**\n * This helper updates the host element to prevent keyboard interaction on its subtree and sets the appropriate aria attribute for accessibility.\n *\n * This should be used in the `componentDidRender` lifecycle hook.\n *\n * **Notes**\n *\n * this util is not needed for simple components whose root element or elements are an interactive component (custom element or native control). For those cases, set the `disabled` props on the root components instead.\n * technically, users can override `tabindex` and restore keyboard navigation, but this will be considered user error\n *\n * @param component\n */\nexport function updateHostInteraction(component) {\n    if (component.disabled) {\n        component.el.setAttribute(\"aria-disabled\", \"true\");\n        if (component.el.contains(document.activeElement)) {\n            document.activeElement.blur();\n        }\n        blockInteraction(component);\n        return;\n    }\n    restoreInteraction(component);\n    component.el.removeAttribute(\"aria-disabled\");\n}\nfunction blockInteraction(component) {\n    component.el.click = interceptedClick;\n    if (isFirefox) {\n        const currentParent = getParentElement(component);\n        const trackedParent = disabledElementToParent.get(component.el);\n        if (trackedParent !== currentParent) {\n            removeInteractionListeners(trackedParent);\n            disabledElementToParent.set(component.el, currentParent);\n        }\n        addInteractionListeners(disabledElementToParent.get(component.el));\n        return;\n    }\n    addInteractionListeners(component.el);\n}\nfunction addInteractionListeners(element) {\n    if (!element) {\n        // this early return path is only applicable to Firefox\n        return;\n    }\n    element.addEventListener(\"pointerdown\", onPointerDown, captureOnlyOptions);\n    nonBubblingWhenDisabledMouseEvents.forEach((event) => element.addEventListener(event, onNonBubblingWhenDisabledMouseEvent, captureOnlyOptions));\n}\nfunction getParentElement(component) {\n    return (component.el.parentElement || component.el); /* assume element is host if it has no parent when connected */\n}\nfunction isInteractiveHTMLElement(el) {\n    return \"disabled\" in el;\n}\nfunction restoreInteraction(component) {\n    delete component.el.click; // fallback on HTMLElement.prototype.click\n    if (isFirefox) {\n        const parent = disabledElementToParent.get(component.el);\n        let hasDisabledSiblingElements = false;\n        if (parent?.children) {\n            for (const child of parent.children) {\n                if (isInteractiveHTMLElement(child) && child.disabled && child !== component.el) {\n                    hasDisabledSiblingElements = true;\n                    break;\n                }\n            }\n        }\n        if (!hasDisabledSiblingElements) {\n            removeInteractionListeners(parent);\n        }\n        disabledElementToParent.delete(component.el);\n        return;\n    }\n    removeInteractionListeners(component.el);\n}\nfunction removeInteractionListeners(element) {\n    if (!element) {\n        // this early return path is only applicable to Firefox\n        return;\n    }\n    element.removeEventListener(\"pointerdown\", onPointerDown, captureOnlyOptions);\n    nonBubblingWhenDisabledMouseEvents.forEach((event) => element.removeEventListener(event, onNonBubblingWhenDisabledMouseEvent, captureOnlyOptions));\n}\n/**\n * This utility helps disable components consistently in Firefox.\n *\n * It needs to be called in `connectedCallback` and is only needed for Firefox as it does not call capture event listeners before non-capture ones (see https://bugzilla.mozilla.org/show_bug.cgi?id=1731504).\n *\n * @param component\n */\nexport function connectInteractive(component) {\n    if (!component.disabled || !isFirefox) {\n        return;\n    }\n    blockInteraction(component);\n}\n/**\n * This utility restores interactivity to disabled components consistently in Firefox.\n *\n * It needs to be called in `disconnectedCallback` and is only needed for Firefox as it does not call capture event listeners before non-capture ones (see https://bugzilla.mozilla.org/show_bug.cgi?id=1731504).\n *\n * @param component\n */\nexport function disconnectInteractive(component) {\n    if (!isFirefox) {\n        return;\n    }\n    restoreInteraction(component);\n}\nexport const CSS = {\n    container: \"interaction-container\",\n};\nexport function InteractiveContainer({ disabled }, children) {\n    return (h(\"div\", { class: CSS.container, inert: disabled }, ...children));\n}\n//# sourceMappingURL=interactive.js.map\n"],"mappings":"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"}